<!DOCTYPE html>

<html>
<head>
  <title>dgauss.hh</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="public/stylesheets/normalize.css" />
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div class="container">
    <div class="page">

      <div class="header">
        
          <h1>dgauss.hh</h1>
        

        
          <div class="toc">
            <h3>Table of Contents</h3>
            <ol>
              
                
                <li>
                  <a class="source" href="colorfactors.html">
                    colorfactors.hh
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="dgauss.html">
                    dgauss.hh
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="distribution.html">
                    distribution.hh
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="evolinit.html">
                    evolinit.hh
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="evolsetup.html">
                    evolsetup.hh
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="grid.html">
                    grid.hh
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="hardoperator.html">
                    hardoperator.hh
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="splittings.html">
                    splittings.hh
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="subgrid.html">
                    subgrid.hh
                  </a>
                </li>
              
            </ol>
          </div>
        
      </div>

      
        
        
        
          <div class='highlight'><pre><span class="hljs-comment">/*
  dgauss.hh

  Author: Valerio Bertone
*/</span>

<span class="hljs-comment">/*
 * Abscissae x[i] and weights w[i] for the 4-, 8-, 16-, 32-, and 64-point
 * Gauss quadrature integration.
 * For reference:
 *
 * I = \int_a^b f(x)dx = (b-a)/2 * sum_{i=1}^n w[i] * { f[ (b+a)/2 + x[i]*(b-a)/2 ] + f[ (b+a)/2 - x[i]*(b-a)/2 ] ]
 *
 */</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cmath&gt;</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;

<span class="hljs-keyword">namespace</span> apfel {

  <span class="hljs-keyword">const</span> <span class="hljs-keyword">double</span> gq_x[<span class="hljs-number">5</span>][<span class="hljs-number">32</span>] = {
    {<span class="hljs-number">0.3399810435848562</span>,
     <span class="hljs-number">0.8611363115940525</span>},
    {<span class="hljs-number">0.1834346424956498</span>,
     <span class="hljs-number">0.5255324099163289</span>,
     <span class="hljs-number">0.7966664774136267</span>,
     <span class="hljs-number">0.9602898564975362</span>},
    {<span class="hljs-number">0.0950125098376374</span>,
     <span class="hljs-number">0.2816035507792589</span>,
     <span class="hljs-number">0.4580167776572273</span>,
     <span class="hljs-number">0.6178762444026437</span>,
     <span class="hljs-number">0.7554044083550030</span>,
     <span class="hljs-number">0.8656312023878317</span>,
     <span class="hljs-number">0.9445750230732325</span>,
     <span class="hljs-number">0.9894009349916499</span>},
    {<span class="hljs-number">0.0483076656877383</span>,
     <span class="hljs-number">0.1444719615827964</span>,
     <span class="hljs-number">0.2392873622521370</span>,
     <span class="hljs-number">0.3318686022821276</span>,
     <span class="hljs-number">0.4213512761306353</span>,
     <span class="hljs-number">0.5068999089322293</span>,
     <span class="hljs-number">0.5877157572407623</span>,
     <span class="hljs-number">0.6630442669302152</span>,
     <span class="hljs-number">0.7321821187402896</span>,
     <span class="hljs-number">0.7944837959679424</span>,
     <span class="hljs-number">0.8493676137325699</span>,
     <span class="hljs-number">0.8963211557660521</span>,
     <span class="hljs-number">0.9349060759377396</span>,
     <span class="hljs-number">0.9647622555875064</span>,
     <span class="hljs-number">0.9856115115452683</span>,
     <span class="hljs-number">0.9972638618494815</span>},
    {<span class="hljs-number">0.0243502926634244</span>,
     <span class="hljs-number">0.0729931217877990</span>,
     <span class="hljs-number">0.1214628192961205</span>,
     <span class="hljs-number">0.1696444204239928</span>,
     <span class="hljs-number">0.2174236437400070</span>,
     <span class="hljs-number">0.2646871622087674</span>,
     <span class="hljs-number">0.3113228719902109</span>,
     <span class="hljs-number">0.3572201583376681</span>,
     <span class="hljs-number">0.4022701579639916</span>,
     <span class="hljs-number">0.4463660172534640</span>,
     <span class="hljs-number">0.4894031457070529</span>,
     <span class="hljs-number">0.5312794640198945</span>,
     <span class="hljs-number">0.5718956462026340</span>,
     <span class="hljs-number">0.6111553551723932</span>,
     <span class="hljs-number">0.6489654712546573</span>,
     <span class="hljs-number">0.6852363130542332</span>,
     <span class="hljs-number">0.7198818501716108</span>,
     <span class="hljs-number">0.7528199072605318</span>,
     <span class="hljs-number">0.7839723589433414</span>,
     <span class="hljs-number">0.8132653151227975</span>,
     <span class="hljs-number">0.8406292962525803</span>,
     <span class="hljs-number">0.8659993981540928</span>,
     <span class="hljs-number">0.8893154459951141</span>,
     <span class="hljs-number">0.9105221370785028</span>,
     <span class="hljs-number">0.9295691721319395</span>,
     <span class="hljs-number">0.9464113748584028</span>,
     <span class="hljs-number">0.9610087996520537</span>,
     <span class="hljs-number">0.9733268277899109</span>,
     <span class="hljs-number">0.9833362538846259</span>,
     <span class="hljs-number">0.9910133714767443</span>,
     <span class="hljs-number">0.9963401167719552</span>,
     <span class="hljs-number">0.9993050417357721</span>}};
  <span class="hljs-keyword">const</span> <span class="hljs-keyword">double</span> gq_w[<span class="hljs-number">5</span>][<span class="hljs-number">32</span>] = {</pre></div>
        
      
        
        <p>4-point integration (2^1 entries)</p>

        
          <div class='highlight'><pre>    {<span class="hljs-number">0.6521451548625461</span>,
     <span class="hljs-number">0.3478548451374538</span>},</pre></div>
        
      
        
        <p>8-point integration (2^2 entries)</p>

        
          <div class='highlight'><pre>    {<span class="hljs-number">0.3626837833783619</span>,
     <span class="hljs-number">0.3137066458778872</span>,
     <span class="hljs-number">0.2223810344533744</span>,
     <span class="hljs-number">0.1012285362903762</span>},</pre></div>
        
      
        
        <p>16-point integration (2^3 entries)</p>

        
          <div class='highlight'><pre>    {<span class="hljs-number">0.1894506104550684</span>,
     <span class="hljs-number">0.1826034150449235</span>,
     <span class="hljs-number">0.1691565193950025</span>,
     <span class="hljs-number">0.1495959888165767</span>,
     <span class="hljs-number">0.1246289712555338</span>,
     <span class="hljs-number">0.0951585116824927</span>,
     <span class="hljs-number">0.0622535239386478</span>,
     <span class="hljs-number">0.0271524594117540</span>},</pre></div>
        
      
        
        <p>32-point integration (2^4 entries)</p>

        
          <div class='highlight'><pre>    {<span class="hljs-number">0.0965400885147278</span>,
     <span class="hljs-number">0.0956387200792748</span>,
     <span class="hljs-number">0.0938443990808045</span>,
     <span class="hljs-number">0.0911738786957638</span>,
     <span class="hljs-number">0.0876520930044038</span>,
     <span class="hljs-number">0.0833119242269467</span>,
     <span class="hljs-number">0.0781938957870703</span>,
     <span class="hljs-number">0.0723457941088485</span>,
     <span class="hljs-number">0.0658222227763618</span>,
     <span class="hljs-number">0.0586840934785355</span>,
     <span class="hljs-number">0.0509980592623761</span>,
     <span class="hljs-number">0.0428358980222266</span>,
     <span class="hljs-number">0.0342738629130214</span>,
     <span class="hljs-number">0.0253920653092620</span>,
     <span class="hljs-number">0.0162743947309056</span>,
     <span class="hljs-number">0.0070186100094700</span>},</pre></div>
        
      
        
        <p>64-point integration (2^5 entries)</p>

        
          <div class='highlight'><pre>    {<span class="hljs-number">0.0486909570091397</span>,
     <span class="hljs-number">0.0485754674415034</span>,
     <span class="hljs-number">0.0483447622348029</span>,
     <span class="hljs-number">0.0479993885964583</span>,
     <span class="hljs-number">0.0475401657148303</span>,
     <span class="hljs-number">0.0469681828162100</span>,
     <span class="hljs-number">0.0462847965813144</span>,
     <span class="hljs-number">0.0454916279274181</span>,
     <span class="hljs-number">0.0445905581637565</span>,
     <span class="hljs-number">0.0435837245293234</span>,
     <span class="hljs-number">0.0424735151236535</span>,
     <span class="hljs-number">0.0412625632426235</span>,
     <span class="hljs-number">0.0399537411327203</span>,
     <span class="hljs-number">0.0385501531786156</span>,
     <span class="hljs-number">0.0370551285402400</span>,
     <span class="hljs-number">0.0354722132568823</span>,
     <span class="hljs-number">0.0338051618371416</span>,
     <span class="hljs-number">0.0320579283548515</span>,
     <span class="hljs-number">0.0302346570724024</span>,
     <span class="hljs-number">0.0283396726142594</span>,
     <span class="hljs-number">0.0263774697150546</span>,
     <span class="hljs-number">0.0243527025687108</span>,
     <span class="hljs-number">0.0222701738083832</span>,
     <span class="hljs-number">0.0201348231535302</span>,
     <span class="hljs-number">0.0179517157756973</span>,
     <span class="hljs-number">0.0157260304760247</span>,
     <span class="hljs-number">0.0134630478967186</span>,
     <span class="hljs-number">0.0111681394601311</span>,
     <span class="hljs-number">0.0088467598263639</span>,
     <span class="hljs-number">0.0065044579689783</span>,
     <span class="hljs-number">0.0041470332605624</span>,
     <span class="hljs-number">0.0017832807216964</span>}};</pre></div>
        
      
        
        <p>Integrating function</p>

        
          <div class='highlight'><pre>  inline double dgauss(double (*f)(double), double const&amp; a, double const&amp; b, int const&amp; n = 1) {
    double I = 0;
    double k1 = ( b - a ) / 2;
    double k2 = ( b + a ) / 2;
    int m = pow(2,n+1);
    for(int i=0; i&lt;m; i++) I += gq_w[n][i] * ( f( k2 + gq_x[n][i] * k1 ) + f( k2 - gq_x[n][i] * k1 ) );
    I *= k1;
    return I;
  };

}</pre></div>
        
      
      <div class="fleur">h</div>
    </div>
  </div>
</body>
</html>
