//
// APFEL++ 2017
//
// Authors: Valerio Bertone: valerio.bertone@cern.ch
//          Stefano Carrazza: stefano.carrazza@cern.ch
//

#pragma once

#include <vector>
#include <functional>

using std::vector;
using std::function;

namespace apfel
{
  /**
   * @brief First 1000 zero's of the first-order Bessel function J0
   * computed with Boost.
   */
  const vector<double> j0Zeros{
    2.404825557695773, 5.520078110286311, 8.653727912911013, 11.79153443901428, 
      14.93091770848779, 18.07106396791092, 21.21163662987926, 24.3524715307493, 
      27.49347913204025, 30.63460646843198, 33.77582021357357, 36.91709835366404, 
      40.05842576462824, 43.19979171317673, 46.34118837166181, 49.48260989739781, 
      52.624051841115,   55.76551075501998, 58.90698392608094, 62.04846919022717, 
      65.18996480020687, 68.3314693298568,  71.47298160359374, 74.61450064370183, 
      77.75602563038805, 80.89755587113763, 84.0390907769382,  87.18062984364116, 
      90.32217263721049, 93.46371878194478, 96.60526795099626, 99.7468198586806, 
      102.8883742541948, 106.0299309164516, 109.1714896498054, 112.3130502804949, 
      115.4546126536669, 118.5961766308725, 121.737742087951,  124.8793089132329, 
      128.0208770060083, 131.1624462752139, 134.3040166383055, 137.4455880202843, 
      140.5871603528543, 143.7287335736897, 146.8703076257966, 150.0118824569548, 
      153.1534580192279, 156.2950342685335, 159.4366111642632, 162.5781886689467, 
      165.719766747955,  168.8613453692358, 172.0029245030782, 175.1445041219027, 
      178.2860842000738, 181.427664713731,  184.5692456406387, 187.7108269600494, 
      190.8524086525815, 193.9939907001091, 197.1355730856614, 200.2771557933324, 
      203.4187388081986, 206.5603221162445, 209.7019057042941, 212.8434895599495, 
      215.985073671534,  219.1266580280406, 222.2682426190843, 225.4098274348593, 
      228.5514124660988, 231.6929977040385, 234.8345831403832, 237.9761687672757, 
      241.117754577268,  244.2593405632957, 247.4009267186528, 250.54251303697, 
      253.6840995121931, 256.8256861385644, 259.9672729106045, 263.1088598230955, 
      266.2504468710659, 269.392034049776,  272.5336213547049, 275.6752087815374, 
      278.8167963261531, 281.9583839846149, 285.0999717531595, 288.2415596281877, 
      291.3831476062552, 294.524735684065,  297.666323858459,  300.8079121264111, 
      303.9495004850206, 307.0910889315051, 310.232677463195,  313.3742660775279, 
      316.5158547720429, 319.6574435443762, 322.7990323922555, 325.9406213134967, 
      329.0822103059986, 332.2237993677396, 335.3653884967741, 338.5069776912285, 
      341.6485669492981, 344.790156269244,  347.9317456493902, 351.0733350881206, 
      354.2149245838764, 357.3565141351538, 360.4981037405011, 363.639693398517, 
      366.7812831078483, 369.9228728671875, 373.0644626752713, 376.2060525308785, 
      379.3476424328285, 382.4892323799793, 385.6308223712264, 388.7724124055006, 
      391.9140024817674, 395.0555925990249, 398.1971827563028, 401.3387729526615, 
      404.4803631871904, 407.6219534590069, 410.7635437672553, 413.9051341111063, 
      417.0467244897553, 420.1883149024216, 423.3299053483481, 426.4714958267996, 
      429.6130863370627, 432.7546768784446, 435.8962674502723, 439.0378580518924, 
      442.1794486826699, 445.3210393419877, 448.462630029246,  451.6042207438617, 
      454.7458114852677, 457.8874022529128, 461.0289930462604, 464.1705838647888, 
      467.31217470799,   470.4537655753699, 473.5953564664471, 476.7369473807533, 
      479.8785383178323, 483.0201292772397, 486.1617202585426, 489.3033112613194, 
      492.444902285159,  495.5864933296609, 498.7280843944346, 501.8696754790994, 
      505.0112665832841, 508.1528577066267, 511.294448848774,  514.4360400093816, 
      517.5776311881133, 520.7192223846409, 523.8608135986445, 527.0024048298116, 
      530.1439960778367, 533.2855873424221, 536.427178623277,  539.5687699201169, 
      542.7103612326645, 545.8519525606483, 548.9935439038036, 552.1351352618713, 
      555.2767266345982, 558.4183180217369, 561.5599094230457, 564.701500838288, 
      567.8430922672325, 570.984683709653,  574.1262751653285, 577.2678666340424, 
      580.409458115583,  583.5510496097432, 586.6926411163203, 589.8342326351157, 
      592.9758241659354, 596.1174157085893, 599.2590072628911, 602.4005988286589, 
      605.5421904057138, 608.6837819938813, 611.8253735929903, 614.9669652028729, 
      618.108556823365,  621.2501484543054, 624.3917400955368, 627.5333317469042, 
      630.6749234082564, 633.8165150794449, 636.9581067603241, 640.0996984507514, 
      643.2412901505867, 646.382881859693,  649.5244735779357, 652.666065305183, 
      655.8076570413053, 658.9492487861759, 662.09084053967,   665.2324323016657, 
      668.3740240720429, 671.515615850684,  674.6572076374736, 677.7987994322984, 
      680.9403912350472, 684.0819830456109, 687.223574863882,  690.3651666897557, 
      693.5067585231285, 696.6483503638989, 699.7899422119673, 702.9315340672358, 
      706.0731259296085, 709.2147177989908, 712.3563096752899, 715.4979015584149, 
      718.6394934482762, 721.7810853447858, 724.9226772478572, 728.0642691574056, 
      731.2058610733475, 734.3474529956007, 737.4890449240849, 740.6306368587203, 
      743.7722287994293, 746.9138207461351, 750.0554126987624, 753.1970046572372, 
      756.3385966214867, 759.4801885914389, 762.6217805670236, 765.7633725481713, 
      768.9049645348141, 772.0465565268846, 775.1881485243169, 778.3297405270463, 
      781.4713325350086, 784.6129245481411, 787.7545165663819, 790.8961085896701, 
      794.0377006179459, 797.1792926511503, 800.3208846892252, 803.4624767321135, 
      806.6040687797589, 809.7456608321061, 812.8872528891006, 816.0288449506887, 
      819.1704370168175, 822.312029087435,  825.4536211624901, 828.595213241932, 
      831.7368053257113, 834.8783974137789, 838.0199895060865, 841.1615816025867, 
      844.3031737032327, 847.4447658079783, 850.5863579167782, 853.7279500295875, 
      856.8695421463623, 860.011134267059,  863.1527263916347, 866.2943185200475, 
      869.4359106522554, 872.5775027882178, 875.7190949278939, 878.8606870712442, 
      882.0022792182293, 885.1438713688106, 888.2854635229497, 891.4270556806093, 
      894.5686478417522, 897.7102400063417, 900.8518321743418, 903.993424345717, 
      907.1350165204321, 910.2766086984528, 913.4182008797447, 916.5597930642743, 
      919.7013852520085, 922.8429774429144, 925.9845696369598, 929.1261618341128, 
      932.2677540343421, 935.4093462376167, 938.5509384439059, 941.6925306531796, 
      944.8341228654079, 947.9757150805616, 951.1173072986116, 954.2588995195295, 
      957.4004917432868, 960.5420839698558, 963.6836761992089, 966.825268431319, 
      969.9668606661595, 973.1084529037037, 976.2500451439255, 979.3916373867992, 
      982.5332296322995, 985.6748218804011, 988.8164141310792, 991.9580063843094, 
      995.0995986400676, 998.2411908983298, 1001.382783159073, 1004.524375422272, 
      1007.665967687907, 1010.807559955952, 1013.949152226387, 1017.090744499189, 
      1020.232336774336, 1023.373929051806, 1026.515521331579, 1029.657113613632, 
      1032.798705897946, 1035.9402981845,   1039.081890473273, 1042.223482764246, 
      1045.365075057397, 1048.506667352709, 1051.648259650162, 1054.789851949736, 
      1057.931444251412, 1061.073036555172, 1064.214628860998, 1067.356221168871, 
      1070.497813478773, 1073.639405790686, 1076.780998104593, 1079.922590420477, 
      1083.064182738319, 1086.205775058104, 1089.347367379814, 1092.488959703433, 
      1095.630552028944, 1098.772144356331, 1101.913736685578, 1105.055329016669, 
      1108.196921349589, 1111.338513684322, 1114.480106020853, 1117.621698359166, 
      1120.763290699246, 1123.904883041079, 1127.04647538465,  1130.188067729945, 
      1133.329660076948, 1136.471252425647, 1139.612844776027, 1142.754437128074, 
      1145.896029481774, 1149.037621837114, 1152.179214194081, 1155.320806552661, 
      1158.462398912841, 1161.603991274608, 1164.745583637949, 1167.887176002851, 
      1171.028768369303, 1174.170360737291, 1177.311953106804, 1180.453545477828, 
      1183.595137850353, 1186.736730224365, 1189.878322599854, 1193.019914976808, 
      1196.161507355214, 1199.303099735062, 1202.444692116341, 1205.586284499039, 
      1208.727876883145, 1211.869469268648, 1215.011061655538, 1218.152654043803, 
      1221.294246433433, 1224.435838824418, 1227.577431216747, 1230.71902361041, 
      1233.860616005396, 1237.002208401696, 1240.143800799299, 1243.285393198197, 
      1246.426985598377, 1249.568577999833, 1252.710170402552, 1255.851762806527, 
      1258.993355211748, 1262.134947618205, 1265.27654002589,  1268.418132434792, 
      1271.559724844903, 1274.701317256215, 1277.842909668718, 1280.984502082403, 
      1284.126094497263, 1287.267686913287, 1290.409279330469, 1293.550871748798, 
      1296.692464168268, 1299.834056588869, 1302.975649010594, 1306.117241433434, 
      1309.258833857381, 1312.400426282428, 1315.542018708567, 1318.683611135789, 
      1321.825203564088, 1324.966795993454, 1328.108388423881, 1331.249980855362, 
      1334.391573287889, 1337.533165721454, 1340.67475815605,  1343.81635059167, 
      1346.957943028307, 1350.099535465954, 1353.241127904603, 1356.382720344247, 
      1359.524312784881, 1362.665905226497, 1365.807497669087, 1368.949090112646, 
      1372.090682557167, 1375.232275002644, 1378.373867449068, 1381.515459896435, 
      1384.657052344738, 1387.79864479397,  1390.940237244125, 1394.081829695198, 
      1397.223422147181, 1400.365014600068, 1403.506607053854, 1406.648199508532, 
      1409.789791964097, 1412.931384420543, 1416.072976877863, 1419.214569336052, 
      1422.356161795105, 1425.497754255015, 1428.639346715776, 1431.780939177384, 
      1434.922531639833, 1438.064124103116, 1441.20571656723,  1444.347309032167, 
      1447.488901497924, 1450.630493964494, 1453.772086431872, 1456.913678900054, 
      1460.055271369033, 1463.196863838805, 1466.338456309365, 1469.480048780707, 
      1472.621641252827, 1475.763233725719, 1478.904826199379, 1482.046418673802, 
      1485.188011148983, 1488.329603624917, 1491.4711961016,   1494.612788579026, 
      1497.754381057191, 1500.895973536091, 1504.037566015721, 1507.179158496075, 
      1510.320750977151, 1513.462343458942, 1516.603935941445, 1519.745528424656, 
      1522.88712090857,  1526.028713393182, 1529.170305878488, 1532.311898364485, 
      1535.453490851167, 1538.595083338531, 1541.736675826573, 1544.878268315287, 
      1548.019860804671, 1551.16145329472,  1554.30304578543,  1557.444638276797, 
      1560.586230768818, 1563.727823261487, 1566.869415754802, 1570.011008248759, 
      1573.152600743352, 1576.29419323858,  1579.435785734438, 1582.577378230921, 
      1585.718970728028, 1588.860563225753, 1592.002155724093, 1595.143748223045, 
      1598.285340722605, 1601.426933222769, 1604.568525723534, 1607.710118224896, 
      1610.851710726852, 1613.993303229398, 1617.134895732531, 1620.276488236248, 
      1623.418080740544, 1626.559673245417, 1629.701265750864, 1632.842858256881, 
      1635.984450763464, 1639.126043270611, 1642.267635778318, 1645.409228286583, 
      1648.550820795401, 1651.69241330477,  1654.834005814686, 1657.975598325147, 
      1661.11719083615,  1664.25878334769,  1667.400375859766, 1670.541968372375, 
      1673.683560885512, 1676.825153399176, 1679.966745913363, 1683.108338428071, 
      1686.249930943295, 1689.391523459035, 1692.533115975286, 1695.674708492047, 
      1698.816301009313, 1701.957893527082, 1705.099486045352, 1708.24107856412, 
      1711.382671083383, 1714.524263603138, 1717.665856123383, 1720.807448644114, 
      1723.94904116533,  1727.090633687027, 1730.232226209204, 1733.373818731856, 
      1736.515411254983, 1739.65700377858,  1742.798596302646, 1745.940188827179, 
      1749.081781352175, 1752.223373877632, 1755.364966403547, 1758.506558929919, 
      1761.648151456745, 1764.789743984022, 1767.931336511748, 1771.07292903992, 
      1774.214521568537, 1777.356114097595, 1780.497706627093, 1783.639299157028, 
      1786.780891687398, 1789.9224842182,   1793.064076749432, 1796.205669281093, 
      1799.347261813179, 1802.488854345689, 1805.63044687862,  1808.772039411971, 
      1811.913631945738, 1815.05522447992,  1818.196817014515, 1821.33840954952, 
      1824.480002084934, 1827.621594620754, 1830.763187156978, 1833.904779693604, 
      1837.04637223063,  1840.187964768054, 1843.329557305875, 1846.471149844089, 
      1849.612742382695, 1852.754334921691, 1855.895927461075, 1859.037520000845, 
      1862.179112540999, 1865.320705081535, 1868.462297622451, 1871.603890163746, 
      1874.745482705417, 1877.887075247462, 1881.02866778988,  1884.170260332669, 
      1887.311852875826, 1890.453445419351, 1893.595037963241, 1896.736630507494, 
      1899.878223052109, 1903.019815597083, 1906.161408142416, 1909.303000688105, 
      1912.444593234148, 1915.586185780544, 1918.727778327291, 1921.869370874388, 
      1925.010963421832, 1928.152555969622, 1931.294148517756, 1934.435741066233, 
      1937.57733361505,  1940.718926164207, 1943.860518713701, 1947.002111263531, 
      1950.143703813696, 1953.285296364193, 1956.426888915021, 1959.568481466179, 
      1962.710074017665, 1965.851666569477, 1968.993259121614, 1972.134851674074, 
      1975.276444226856, 1978.418036779957, 1981.559629333378, 1984.701221887116, 
      1987.842814441169, 1990.984406995536, 1994.125999550216, 1997.267592105208, 
      2000.409184660508, 2003.550777216117, 2006.692369772033, 2009.833962328255, 
      2012.97555488478,  2016.117147441607, 2019.258739998736, 2022.400332556165, 
      2025.541925113891, 2028.683517671915, 2031.825110230234, 2034.966702788847, 
      2038.108295347753, 2041.249887906951, 2044.391480466439, 2047.533073026215, 
      2050.674665586279, 2053.816258146629, 2056.957850707264, 2060.099443268182, 
      2063.241035829383, 2066.382628390864, 2069.524220952625, 2072.665813514664, 
      2075.807406076981, 2078.948998639573, 2082.09059120244,  2085.232183765581, 
      2088.373776328994, 2091.515368892677, 2094.65696145663,  2097.798554020851, 
      2100.940146585341, 2104.081739150095, 2107.223331715115, 2110.364924280399, 
      2113.506516845945, 2116.648109411752, 2119.78970197782,  2122.931294544147, 
      2126.072887110731, 2129.214479677572, 2132.356072244669, 2135.497664812021, 
      2138.639257379625, 2141.780849947482, 2144.92244251559,  2148.064035083949, 
      2151.205627652555, 2154.34722022141,  2157.488812790512, 2160.63040535986, 
      2163.771997929452, 2166.913590499287, 2170.055183069365, 2173.196775639685, 
      2176.338368210244, 2179.479960781044, 2182.621553352082, 2185.763145923357, 
      2188.904738494868, 2192.046331066614, 2195.187923638595, 2198.329516210809, 
      2201.471108783255, 2204.612701355933, 2207.754293928841, 2210.895886501978, 
      2214.037479075343, 2217.179071648936, 2220.320664222755, 2223.462256796799, 
      2226.603849371068, 2229.745441945561, 2232.887034520276, 2236.028627095213, 
      2239.17021967037,  2242.311812245747, 2245.453404821344, 2248.594997397157, 
      2251.736589973189, 2254.878182549436, 2258.019775125898, 2261.161367702575, 
      2264.302960279465, 2267.444552856567, 2270.586145433881, 2273.727738011407, 
      2276.869330589142, 2280.010923167086, 2283.152515745238, 2286.294108323597, 
      2289.435700902163, 2292.577293480935, 2295.718886059911, 2298.860478639092, 
      2302.002071218475, 2305.143663798061, 2308.285256377848, 2311.426848957835, 
      2314.568441538023, 2317.71003411841,  2320.851626698994, 2323.993219279776, 
      2327.134811860755, 2330.276404441929, 2333.417997023299, 2336.559589604862, 
      2339.701182186619, 2342.842774768569, 2345.984367350711, 2349.125959933043, 
      2352.267552515566, 2355.409145098279, 2358.55073768118,  2361.692330264269, 
      2364.833922847547, 2367.97551543101,  2371.117108014659, 2374.258700598493, 
      2377.400293182512, 2380.541885766714, 2383.683478351099, 2386.825070935667, 
      2389.966663520415, 2393.108256105344, 2396.249848690454, 2399.391441275743, 
      2402.533033861211, 2405.674626446856, 2408.816219032679, 2411.957811618678, 
      2415.099404204853, 2418.240996791203, 2421.382589377728, 2424.524181964426, 
      2427.665774551298, 2430.807367138342, 2433.948959725558, 2437.090552312945, 
      2440.232144900502, 2443.373737488229, 2446.515330076126, 2449.65692266419, 
      2452.798515252423, 2455.940107840823, 2459.081700429389, 2462.223293018122, 
      2465.36488560702,  2468.506478196082, 2471.648070785308, 2474.789663374698, 
      2477.931255964251, 2481.072848553966, 2484.214441143842, 2487.356033733879, 
      2490.497626324077, 2493.639218914434, 2496.780811504951, 2499.922404095626, 
      2503.063996686459, 2506.205589277449, 2509.347181868596, 2512.488774459899, 
      2515.630367051358, 2518.771959642972, 2521.91355223474,  2525.055144826661, 
      2528.196737418737, 2531.338330010965, 2534.479922603345, 2537.621515195876, 
      2540.763107788559, 2543.904700381392, 2547.046292974375, 2550.187885567507, 
      2553.329478160788, 2556.471070754217, 2559.612663347794, 2562.754255941518, 
      2565.895848535389, 2569.037441129406, 2572.179033723567, 2575.320626317875, 
      2578.462218912327, 2581.603811506922, 2584.745404101661, 2587.886996696543, 
      2591.028589291567, 2594.170181886733, 2597.311774482041, 2600.453367077489, 
      2603.594959673077, 2606.736552268806, 2609.878144864674, 2613.01973746068, 
      2616.161330056825, 2619.302922653107, 2622.444515249527, 2625.586107846084, 
      2628.727700442777, 2631.869293039606, 2635.01088563657,  2638.152478233669, 
      2641.294070830902, 2644.435663428269, 2647.57725602577,  2650.718848623404, 
      2653.86044122117,  2657.002033819068, 2660.143626417098, 2663.285219015259, 
      2666.42681161355,  2669.568404211972, 2672.709996810523, 2675.851589409203, 
      2678.993182008013, 2682.13477460695,  2685.276367206016, 2688.417959805209, 
      2691.559552404528, 2694.701145003975, 2697.842737603547, 2700.984330203246, 
      2704.125922803069, 2707.267515403018, 2710.40910800309,  2713.550700603286, 
      2716.692293203606, 2719.833885804049, 2722.975478404615, 2726.117071005303, 
      2729.258663606112, 2732.400256207044, 2735.541848808095, 2738.683441409268, 
      2741.825034010561, 2744.966626611973, 2748.108219213505, 2751.249811815155, 
      2754.391404416924, 2757.532997018811, 2760.674589620816, 2763.816182222938, 
      2766.957774825177, 2770.099367427532, 2773.240960030003, 2776.382552632591, 
      2779.524145235293, 2782.665737838111, 2785.807330441042, 2788.948923044088, 
      2792.090515647248, 2795.232108250521, 2798.373700853907, 2801.515293457406, 
      2804.656886061016, 2807.798478664739, 2810.940071268573, 2814.081663872519, 
      2817.223256476575, 2820.364849080741, 2823.506441685017, 2826.648034289403, 
      2829.789626893898, 2832.931219498502, 2836.072812103215, 2839.214404708036, 
      2842.355997312965, 2845.497589918,    2848.639182523144, 2851.780775128393, 
      2854.92236773375,  2858.063960339212, 2861.20555294478,  2864.347145550453, 
      2867.488738156231, 2870.630330762114, 2873.771923368101, 2876.913515974193, 
      2880.055108580388, 2883.196701186685, 2886.338293793087, 2889.47988639959, 
      2892.621479006196, 2895.763071612904, 2898.904664219714, 2902.046256826624, 
      2905.187849433636, 2908.329442040749, 2911.471034647961, 2914.612627255274, 
      2917.754219862686, 2920.895812470198, 2924.037405077809, 2927.178997685518, 
      2930.320590293325, 2933.462182901231, 2936.603775509235, 2939.745368117336, 
      2942.886960725534, 2946.028553333829, 2949.17014594222,  2952.311738550708, 
      2955.453331159291, 2958.594923767971, 2961.736516376745, 2964.878108985614, 
      2968.019701594578, 2971.161294203636, 2974.302886812789, 2977.444479422035, 
      2980.586072031375, 2983.727664640808, 2986.869257250333, 2990.010849859952, 
      2993.152442469662, 2996.294035079465, 2999.43562768936,  3002.577220299345, 
      3005.718812909422, 3008.86040551959,  3012.001998129848, 3015.143590740197, 
      3018.285183350636, 3021.426775961164, 3024.568368571782, 3027.709961182489, 
      3030.851553793285, 3033.99314640417,  3037.134739015143, 3040.276331626204, 
      3043.417924237353, 3046.559516848589, 3049.701109459913, 3052.842702071323, 
      3055.984294682821, 3059.125887294404, 3062.267479906075, 3065.40907251783, 
      3068.550665129672, 3071.692257741599, 3074.833850353611, 3077.975442965708, 
      3081.11703557789,  3084.258628190155, 3087.400220802505, 3090.541813414939, 
      3093.683406027457, 3096.824998640057, 3099.966591252742, 3103.108183865508, 
      3106.249776478357, 3109.391369091289, 3112.532961704303, 3115.674554317398, 
      3118.816146930576, 3121.957739543834, 3125.099332157173, 3128.240924770594, 
      3131.382517384095, 3134.524109997676, 3137.665702611337, 3140.807295225079};

  /**
   * @brief Function that performs the Hankel-transform of the input
   * function using the Ogata quadrature method described here:
   * http://www.kurims.kyoto-u.ac.jp/~okamoto/paper/Publ_RIMS_DE/41-4-40.pdf.
   * @param func: the function to be transformed
   * @param CutOff: the accuracy computed as a cutoff on the size of the last computed term relative to the total
   * @param h: internal variable of the algorithm (default: 0.001)
   * @return the Hankel-transform of the input function computed in qT
   */
  double OgataQuadrature(function<double(double const&)> const& func,
			 double                          const& qT,
			 double                          const& CutOff = 1e-5,
			 double                          const& h = 0.001);
}
